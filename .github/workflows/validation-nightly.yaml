name: Snapshots Validation
on:
  workflow_dispatch:
  schedule:
    - cron: '0 1 * * *'
jobs:
  snapshot-main:
    name: "Quarkus-Hilla main"
    strategy:
      fail-fast: false
      matrix:
        hilla: ["2.3-SNAPSHOT", "2.2-SNAPSHOT", "2.1-SNAPSHOT"]
        java: [ 17, 20 ]
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - uses: ./.github/actions/run-validation
        with:
          ref: ${{ github.event_name == 'schedule' && 'main' || github.ref }}
          java_version: ${{ matrix.java }}
          hilla_version: ${{ matrix.hilla }}
  snapshot-1_0:
    name: "Quarkus-Hilla 1.x"
    strategy:
      fail-fast: false
      matrix:
        hilla: ["1.3-SNAPSHOT"]
        java: [ 11, 17, 20 ]
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - uses: ./.github/actions/run-validation
        with:
          ref: "1.0"
          java_version: ${{ matrix.java }}
          hilla_version: ${{ matrix.hilla }}
